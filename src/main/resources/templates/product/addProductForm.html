<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="fragment/_layout">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <title>타이틀</title>

    <script th:inline="javascript">

            let cteL;

            $(document).ready(function(){
                let cateList = [[${cateList}]];
                cteL = document.getElementById('categoryList');
                let select = document.createElement('select');
                cteL.appendChild(select);
                for (let i = 0; i < cateList.length; i++) {
                    if (cateList[i].tier == '1') {
                    let optionDIV = document.createElement('option');
                    optionDIV.text = cateList[i].categoryName;
                    if (cateList[i].children.length !== 0) {
                        optionDIV.addEventListener('click', function() {
                            childSelect(cateList[i].children);
                        });
                    }
                    select.appendChild(optionDIV);
                    }
                }

                function childSelect(children) {
                    let childrenSelect = document.createElement('select');
                    children.forEach(element => {
                    let optionDIV = document.createElement('option');
                    optionDIV.text = element.categoryName;
                    if (element.children.length !== 0) {
                        optionDIV.addEventListener('click', function() {
                            childSelect(element.children);
                        });
                    }
                    childrenSelect.appendChild(optionDIV);
                    });

                    cteL.appendChild(childrenSelect);
                }
        });
    </script>
</head>
<body>
<div layout:fragment="content">
    <section>
        <form th:action="@{/product/addProduct}" id="addProductForm" th:object="${product}" method="post">
            <div id="categoryList">

            </div>
            <select name="" id=""><option value=""></option></select>
            <input type="text" name="product_name" th:field="*{product_name}">
            <input type="text" name="product_content" th:field="*{product_content}">
            <input type="number" name="price" th:field="*{price}">
            <input type="number" name="amount" th:field="*{amount}">
            <input type="file" name="productImgs" multiple>
            <button type="submit">Submit</button>
          </form>
        <article></article>
    </section>
</div>
</body>
</html>