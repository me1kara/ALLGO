<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="fragment/_layout">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <title>타이틀</title>
    <style>
    </style>
    <script>
        $(document).ready(function() {
        $('#check-username').click(function() {
            var username = $('#username').val();
            $.ajax({
            url: '/checkUsername',
            type: 'POST',
            data: {username: username},
            success: function(response) {
                if (response == 'available') {
                $('#username-message').html('사용 가능한 ID입니다.').css('color', 'green');
                } else {
                $('#username-message').html('이미 사용중인 ID입니다.').css('color', 'red');
                }
            }
            });
        });
        const usernameRegex = /^[a-zA-Z0-9]{1,5}$/;
        const passwordRegex = /^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[a-zA-Z]).{8,20}$/;
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        const phoneRegex = /^\d{3}-\d{3,4}-\d{4}$/;
        const ssnRegex = /^\d{6}-[1-4]\d{6}$/;
        
        });
        function validateRegisterForm() {
            // 필수 항목 검사
            var usernameInput = document.getElementById("username");
            var passwordInput = document.getElementById("password");
            var passwordConfirmInput = document.getElementById("password-confirm");
            var emailInput = document.getElementById("email");
            var phoneInput = document.getElementById("phone");
            var ssnInput = document.getElementById("ssn");
            var agreeInput = document.getElementById("agree");

            var username = usernameInput.value.trim();

            if (username === "") {
                displayErrorMessage(usernameInput, "ID를 입력해주세요.");
                valid = false;
            } else if (!usernameRegex.test(username)) {
                displayErrorMessage(usernameInput, "ID는 4~12자의 영문 대소문자와 숫자만 입력 가능합니다.");
                valid = false;
            } else {
                clearErrorMessage(usernameInput);
            }

            // Validate password
            var password = passwordInput.value.trim();
            if (password === "") {
                displayErrorMessage(passwordInput, "비밀번호를 입력해주세요.");
                valid = false;
            } else if (!passwordRegex.test(password)) {
                displayErrorMessage(passwordInput, "비밀번호는 영문 대소문자, 숫자, 특수문자를 포함한 8자 이상이어야 합니다.");
                valid = false;
            } else {
                clearErrorMessage(passwordInput);
            }

            // Validate password confirmation
            var passwordConfirm = passwordConfirmInput.value.trim();
            if (passwordConfirm === "") {
                displayErrorMessage(passwordConfirmInput, "비밀번호 확인을 입력해주세요.");
                valid = false;
            } else if (password !== passwordConfirm) {
                displayErrorMessage(passwordConfirmInput, "비밀번호와 일치하지 않습니다.");
                valid = false;
            } else {
                clearErrorMessage(passwordConfirmInput);
            }

            // Validate email
            var email = emailInput.value.trim();
            if (email === "") {
                displayErrorMessage(emailInput, "이메일을 입력해주세요.");
                valid = false;
            } else if (!emailRegex.test(email)) {
                displayErrorMessage(emailInput, "이메일 형식이 올바르지 않습니다.");
                valid = false;
            } else {
                clearErrorMessage(emailInput);
            }

            // Validate phone number
            var phone = phoneInput.value.trim();
            if (phone === "") {
                displayErrorMessage(phoneInput, "전화번호를 입력해주세요.");
                valid = false;
            } else if (!phoneRegex.test(phone)) {
                displayErrorMessage(phoneInput, "전화번호 형식이 올바르지 않습니다. (ex. 010-1234-5678)");
                valid = false;
            } else {
                clearErrorMessage(phoneInput);
            }

            if (ssn === "") {
                alert("주민등록번호를 입력해주세요.");
                return false;
            }

            if (!agree) {
                alert("개인정보 수집 및 이용에 동의해주세요.");
                return false;
            }

            // 추가적인 유효성 검사

            // ...

            return true;
            }
    </script>
</head>
<body>
    <div layout:fragment="content">
        <!-- content script -->
        <div class="register-container">
            <form action="registerCheck" method="post" class="register-form" onsubmit="return validateRegisterForm()">
              <h2>회원가입</h2>
              <div class="form-group register-group">
                <label for="username">ID</label>
                <input type="text" id="username" name="username">
                <button type="button" id="check-username">중복확인</button>
                <div id="username-message"></div>
              </div>
              <div class="form-group register-group">
                <label for="password">비밀번호</label>
                <input type="password" id="password" name="password">
              </div>
              <div class="form-group register-group">
                <label for="password-confirm">비밀번호 확인</label>
                <input type="password" id="password-confirm" name="password-confirm">
              </div>
              <div class="form-group register-group">
                <label for="email">이메일</label>
                <input type="email" id="email" name="email">
              </div>
              <div class="form-group register-group">
                <label for="phone">전화번호</label>
                <input type="tel" id="phone" name="phone">
              </div>
              <div class="form-group register-group">
                <label for="ssn">주민등록번호</label>
                <input type="text" id="ssn" name="ssn">
                <button type="button" id="check-ssn">중복확인</button>
                <div id="ssn-message"></div>
              </div>
              <div class="form-group register-group">
                <label for="agree">개인정보 수집 및 이용 동의</label>
                <input type="checkbox" id="agree" name="agree">
                <label for="agree">본인은 개인정보 수집 및 이용에 동의합니다.</label>
              </div>
              <div class="form-group register-group">
                <input type="submit" value="회원가입">
              </div>
            </form>
          </div>
    </div>
</body>
</html>